import { ConfigService } from '@nestjs/config';
import { JwtService } from '@nestjs/jwt';
import { Repository } from 'typeorm';
import { RefreshToken, User, Vendor } from '../../entities';
import { UsersService } from '../users/users.service';
import { RegisterUserDto } from './dto/register-user.dto';
import { RegisterCustomerDto } from './dto/register-customer.dto';
import { TokenResponseDto } from './dto/token-response.dto';
import { AuthAudience, UserRole } from './types/auth.types';
import { CustomersService } from '../customers/customers.service';
export declare class AuthService {
    private readonly usersService;
    private readonly jwt;
    private readonly config;
    private readonly refreshTokenRepo;
    private readonly vendorsRepo;
    private readonly customersService;
    private readonly logger;
    private readonly saltRounds;
    constructor(usersService: UsersService, jwt: JwtService, config: ConfigService, refreshTokenRepo: Repository<RefreshToken>, vendorsRepo: Repository<Vendor>, customersService: CustomersService);
    register(dto: RegisterUserDto): Promise<TokenResponseDto>;
    registerCustomer(dto: RegisterCustomerDto): Promise<TokenResponseDto>;
    login(user: User, audience?: AuthAudience): Promise<TokenResponseDto>;
    getCurrentUser(userId: string, activeRole?: UserRole): Promise<import("./dto/token-response.dto").AuthUserDto>;
    refresh(refreshToken: string): Promise<TokenResponseDto>;
    logout(refreshToken: string, userId: string): Promise<{
        success: true;
    }>;
    validateUser(email: string, password: string): Promise<User>;
    private issueTokens;
    private persistRefreshToken;
    private cleanupExpiredTokens;
    private verifyRefreshToken;
    private buildAccessPayload;
    private buildRefreshPayload;
    private mapUserWithVendor;
    private hashToken;
    private getAccessTokenSecret;
    private getRefreshTokenSecret;
    private getAccessTokenTtlSeconds;
    private getRefreshTokenTtlSeconds;
    private parseDurationSeconds;
    private resolveActiveRole;
}
